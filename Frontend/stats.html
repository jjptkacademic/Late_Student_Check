<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024, initial-scale=0.5, minimum-scale=0.3, maximum-scale=2.0, user-scalable=yes">
    <title>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏•‡∏∞ Ranking - ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤‡∏™‡∏≤‡∏¢</title>
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/stats.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <button id="backBtn" class="btn btn-icon">‚¨ÖÔ∏è</button>
                    <button id="homeBtn" class="btn btn-icon">üè†</button>
                    <h1>üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏™‡∏≤‡∏¢</h1>
                </div>
                <div class="header-right">
                    <button id="chartsBtn" class="btn btn-secondary btn-sm">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
                    <button id="refreshBtn" class="btn btn-icon" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä">üîÑ</button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <section class="filters-section">
                <div class="filters">
                    <div class="filter-group">
                        <label for="classFilter">‡∏´‡πâ‡∏≠‡∏á:</label>
                        <select id="classFilter" class="filter-select">
                            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="periodFilter">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤:</label>
                        <select id="periodFilter" class="filter-select">
                            <option value="today">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</option>
                            <option value="week">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</option>
                            <option value="month" selected>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</option>
                            <option value="year">‡∏õ‡∏µ‡∏ô‡∏µ‡πâ</option>
                        </select>
                    </div>
                </div>
            </section>

            <div id="loadingSpinner" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </div>

            <section class="stats-overview">
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-info">
                            <h3>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                            <p class="stat-value" id="totalLate">0</p>
                            <span class="stat-label">‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-info">
                            <h3>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                            <p class="stat-value" id="totalStudents">0</p>
                            <span class="stat-label">‡∏Ñ‡∏ô</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-info">
                            <h3>‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h3>
                            <p class="stat-value" id="avgLate">0</p>
                            <span class="stat-label">‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏Ñ‡∏ô</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-info">
                            <h3>‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡∏™‡∏∏‡∏î</h3>
                            <p class="stat-value" id="topClass">-</p>
                            <span class="stat-label" id="topClassCount"></span>
                        </div>
                    </div>
                </div>
            </section>

            <section class="ranking-section">
                <div class="ranking-header">
                    <h2 style="margin: 0 0 var(--space-sm) 0; font-size: var(--font-lg); text-align: center;">üìã ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏°‡∏≤‡∏™‡∏≤‡∏¢</h2>
                    <div style="display: flex; justify-content: center; align-items: center; gap: var(--space-md);">
                        <div style="display: flex; gap: var(--space-md); align-items: center; width: 680px; justify-content: space-between;">
                            <div style="display: flex; gap: var(--space-md); align-items: center;">
                                <div class="control-group">
                                    <label for="limitSelect">‡πÅ‡∏™‡∏î‡∏á:</label>
                                    <select id="limitSelect" class="filter-select" style="width: auto; min-width: 90px; padding: var(--space-xs) var(--space-sm); font-size: var(--font-sm);">
                                        <option value="10">10 ‡∏Ñ‡∏ô</option>
                                        <option value="20">20 ‡∏Ñ‡∏ô</option>
                                        <option value="30">30 ‡∏Ñ‡∏ô</option>
                                        <option value="50">50 ‡∏Ñ‡∏ô</option>
                                        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label for="minTimesFilter">‡∏°‡∏≤‡∏™‡∏≤‡∏¢‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤:</label>
                                    <button id="decreaseBtn" class="btn-small">-</button>
                                    <input type="range" id="minTimesFilter" min="1" max="20" value="1" step="1">
                                    <button id="increaseBtn" class="btn-small">+</button>
                                    <span id="minTimesValue">1</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                                </div>
                            </div>
                            <button id="copyStatsBtn" class="btn btn-secondary btn-sm">üìã Copy</button>
                        </div>
                    </div>
                </div>
                
                <div class="ranking-table-container">
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th>‡∏ä‡∏±‡πâ‡∏ô</th>
                                <th>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</th>
                            </tr>
                        </thead>
                        <tbody id="rankingTableBody">
                            <!-- Ranking rows loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div id="noDataMessage" class="no-data" style="display: none;">
                    <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤‡∏™‡∏≤‡∏¢‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                </div>
            </section>

            <section class="chart-section">
                <h2>üìä ‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</h2>
                <div id="classChart" class="chart-container">
                    <!-- Chart loaded here -->
                </div>
            </section>

            <section class="actions-section">
                <button id="exportBtn" class="btn btn-outline">üìÑ Export Excel</button>
                <button id="printBtn" class="btn btn-outline">üñ®Ô∏è Print</button>
            </section>
        </main>
    </div>

    <div id="detailModal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏™‡∏≤‡∏¢</h3>
                <button class="modal-close" id="closeDetailModal">‚úñÔ∏è</button>
            </div>
            <div class="modal-body">
                <div class="student-info">
                    <p><strong>üë§ ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong> <span id="detailName"></span></p>
                    <p><strong>üè´ ‡∏´‡πâ‡∏≠‡∏á:</strong> <span id="detailClass"></span></p>
                    <p><strong>üî¢ ‡∏£‡∏´‡∏±‡∏™:</strong> <span id="detailCode"></span></p>
                    <p><strong>üìä ‡∏°‡∏≤‡∏™‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</strong> <span id="detailTotal"></span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                </div>
                <h4>üìÖ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏™‡∏≤‡∏¢:</h4>
                <div id="detailHistory" class="history-list">
                    <!-- History loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="closeDetailBtn" class="btn btn-primary">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>
    </div>

    <script src="js/performance-monitor.js"></script>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/api-helper.js"></script>
    <script src="js/components.js"></script>
    <script src="js/stats.js"></script>
</body>
</html>
